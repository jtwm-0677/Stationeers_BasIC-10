<UserControl x:Class="BasicToMips.UI.VisualScripting.Canvas.VisualCanvas"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d"
             d:DesignHeight="600" d:DesignWidth="800"
             Focusable="True"
             Background="{DynamicResource EditorBackgroundBrush}"
             MouseDown="UserControl_MouseDown"
             MouseMove="UserControl_MouseMove"
             MouseUp="UserControl_MouseUp"
             MouseWheel="UserControl_MouseWheel">
    <Grid x:Name="RootGrid" ClipToBounds="False">
        <!-- Canvas layer with transform -->
        <Canvas x:Name="DrawingCanvas"
                Background="Transparent"
                MouseDown="Canvas_MouseDown"
                MouseMove="Canvas_MouseMove"
                MouseUp="Canvas_MouseUp"
                MouseWheel="Canvas_MouseWheel"
                MouseLeave="Canvas_MouseLeave">
            <Canvas.RenderTransform>
                <TransformGroup>
                    <ScaleTransform x:Name="ScaleTransform" ScaleX="1" ScaleY="1"/>
                    <TranslateTransform x:Name="TranslateTransform" X="0" Y="0"/>
                </TransformGroup>
            </Canvas.RenderTransform>

            <!-- Grid and content will be drawn programmatically -->
        </Canvas>

        <!-- Overlay for UI elements (not transformed) -->
        <Canvas x:Name="OverlayCanvas" IsHitTestVisible="False">
            <!-- Zoom indicator -->
            <Border x:Name="ZoomIndicator"
                    Background="{DynamicResource TertiaryBackgroundBrush}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1"
                    CornerRadius="4"
                    Padding="8,4"
                    Canvas.Right="16"
                    Canvas.Bottom="16"
                    Opacity="0.9">
                <StackPanel Orientation="Horizontal">
                    <TextBlock Text="&#xE71E;" FontFamily="Segoe MDL2 Assets" FontSize="12"
                               Foreground="{DynamicResource SecondaryTextBrush}" VerticalAlignment="Center"/>
                    <TextBlock x:Name="ZoomText" Text="100%"
                               Margin="6,0,0,0" FontSize="12"
                               Foreground="{DynamicResource PrimaryTextBrush}" VerticalAlignment="Center"/>
                </StackPanel>
            </Border>

            <!-- Pan hint (shown when space is held) -->
            <Border x:Name="PanHint"
                    Background="{DynamicResource TertiaryBackgroundBrush}"
                    BorderBrush="{DynamicResource AccentBrush}"
                    BorderThickness="2"
                    CornerRadius="4"
                    Padding="12,8"
                    Visibility="Collapsed"
                    HorizontalAlignment="Center"
                    VerticalAlignment="Center">
                <StackPanel>
                    <TextBlock Text="Pan Mode Active" FontWeight="SemiBold"
                               Foreground="{DynamicResource AccentBrush}" HorizontalAlignment="Center"/>
                    <TextBlock Text="Click and drag to pan" FontSize="11"
                               Foreground="{DynamicResource SecondaryTextBrush}"
                               HorizontalAlignment="Center" Margin="0,4,0,0"/>
                </StackPanel>
            </Border>
        </Canvas>
    </Grid>
</UserControl>
