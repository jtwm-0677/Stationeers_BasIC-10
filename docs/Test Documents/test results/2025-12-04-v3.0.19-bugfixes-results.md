# Test Results: v3.0.19 Bug Fixes

**Version:** 3.0.19
**Date:** 2025-12-04
**Tester:** Claude Code (QA Instance)
**Test Plan:** `2025-12-04-v3.0.19-bugfixes.md`

---

## Executive Summary

| Category | Result |
|----------|--------|
| **Overall Status** | **BLOCKED** |
| **MCP Tests Executed** | 12/12 |
| **MCP Tests Passed** | 11/12 |
| **Manual Tests Required** | 1 (LOOP-REGRESSION: Loop button auto-resume) |
| **Blocking Bugs** | 1 (BUG-001: VS code not compiling to IC10) |

---

## Test Results

### DEFAULT-01: Default Script Compiles
| Item | Result |
|------|--------|
| **Status** | **PASS** |
| **IC10 Lines** | 47 |
| **Errors** | None |
| **Notes** | Default script with GOSUB/RETURN, IF/ELSEIF/ELSE, nested IF all compile correctly |

---

### DEFAULT-02: Default Script Runs in Simulator
| Item | Result |
|------|--------|
| **Status** | **PASS** |
| **Instructions Executed** | 30 |
| **Final PC** | 30 |
| **Status at Yield** | YIELDING |
| **Register Values** | r0=101.325 (pressure), r2=293.15 (temp), ra=29 (return address) |

---

### VS-DEVICE-01: NamedDevice Node Properties
| Item | Result |
|------|--------|
| **Status** | **PASS** |
| **Evidence** | Node now has three properties: |
| | - `AliasName`: Variable name |
| | - `PrefabName`: Device type |
| | - `DeviceName`: Labeler name (NEW) |

---

### VS-DEVICE-02: NamedDevice Code Generation
| Item | Result |
|------|--------|
| **Status** | **PASS** |
| **Test Input** | AliasName="myVent", PrefabName="StructureActiveVent", DeviceName="Main Vent" |
| **Generated Code** | `ALIAS myVent = IC.Device[StructureActiveVent].Name["Main Vent"]` |
| **Expected** | `ALIAS myVent = IC.Device[StructureActiveVent].Name["Main Vent"]` |
| **Match** | Exact match |

---

### VS-MAIN-01: Main Label Generated
| Item | Result |
|------|--------|
| **Status** | **PASS** |
| **Evidence** | Generated code includes: |
```basic
# --- Main ---
Main:
```

---

### VS-IF-01: IF Block Structure Correct
| Item | Result |
|------|--------|
| **Status** | **PASS** |
| **Test Setup** | IF node at y=500, Increment node (True branch) at y=350 (ABOVE IF) |
| **Generated Code** | |
```basic
IF (x = 0) THEN
    ++x
ENDIF
```
| **Evidence** | True branch code (`++x`) appears INSIDE IF block, not before it |

---

### VS-IF-02: Nested IF Structure
| Item | Result |
|------|--------|
| **Status** | **PASS** |
| **Test Setup** | Outer IF (x = 0), nested Inner IF (y = 0), Increment in inner True branch |
| **Generated Code** | |
```basic
IF (x = 0) THEN
    IF (y = 0) THEN
        ++x
    ENDIF
ENDIF
```
| **Evidence** | Proper nesting with correct indentation, all ENDIF statements present |

---

### VS-IF-03: IF with ELSE Branch
| Item | Result |
|------|--------|
| **Status** | **PASS** |
| **Test Setup** | IF (status = 0), True branch: ++status, False branch: status += 0 |
| **Generated Code** | |
```basic
IF (status = 0) THEN
    ++status
ELSE
    status += 0
ENDIF
```
| **Evidence** | IF/THEN present, True branch code inside IF block, ELSE keyword present, False branch code after ELSE, ENDIF closes structure |

---

### ERR-01: Missing ENDIF Reports Correct Line
| Item | Result |
|------|--------|
| **Status** | **PASS** |
| **Test Script** | |
```basic
IF x > 0 THEN
  y = 1
REM no ENDIF
```
| **Error Message** | `Line 1: Incomplete IF statement (started at line 1) - expected ENDIF, ELSE, or ELSEIF but found Eof` |
| **Expected Line** | Line 1 |
| **Actual Line** | Line 1 |

---

### ERR-02: Nested Missing ENDIF
| Item | Result |
|------|--------|
| **Status** | **PASS** |
| **Test Script** | |
```basic
IF x > 0 THEN
  IF y > 0 THEN
    z = 1
  ENDIF
REM outer missing ENDIF
```
| **Error Message** | `Line 1: Incomplete IF statement (started at line 1)` |
| **Expected** | Points to line 1 (outer IF) |
| **Actual** | Points to line 1 |

---

### ERR-03: Missing ENDIF in ELSEIF
| Item | Result |
|------|--------|
| **Status** | **PASS** |
| **Test Script** | |
```basic
IF x = 1 THEN
  a = 1
ELSEIF x = 2 THEN
  b = 2
REM missing ENDIF
```
| **Error Message** | `Line 1: Incomplete ELSEIF statement (IF started at line 1)` |
| **Expected** | References line 1 (IF start) |
| **Actual** | References line 1 |

---

### LOOP-REGRESSION: Simulator Loop Mode
| Item | Result |
|------|--------|
| **Status** | **PARTIAL - Manual UI Required** |
| **Compilation** | PASS - 6 IC10 lines generated |
| **Simulator Run** | PASS - Runs to YIELD, status YIELDING, r0=1 |
| **Loop Button** | NOT TESTED (requires manual UI) |
| **Notes** | MCP has no `basic10_simulator_loop_start` command. Loop mode (auto-resume after yield pause) requires manual verification of the Loop button in the Simulator UI. |

---

## Summary Table

| Test ID | Priority | Status |
|---------|----------|--------|
| DEFAULT-01 | Critical | **PASS** |
| DEFAULT-02 | High | **PASS** |
| VS-DEVICE-01 | High | **PASS** |
| VS-DEVICE-02 | Critical | **PASS** |
| VS-MAIN-01 | High | **PASS** |
| VS-IF-01 | Critical | **PASS** |
| VS-IF-02 | High | **PASS** |
| VS-IF-03 | High | **PASS** |
| ERR-01 | Critical | **PASS** |
| ERR-02 | High | **PASS** |
| ERR-03 | Medium | **PASS** |
| LOOP-REGRESSION | High | **PARTIAL** (Manual UI Required) |

---

## Critical Tests Summary

| Critical Test | Result |
|--------------|--------|
| DEFAULT-01 | **PASS** |
| VS-DEVICE-02 | **PASS** |
| VS-IF-01 | **PASS** |
| ERR-01 | **PASS** |

**All critical tests passed.**

---

## Manual Testing Required

**LOOP-REGRESSION:** The Loop button auto-resume functionality must be manually verified:

- [x] Click Loop button in Simulator UI - **VERIFIED**
- [x] Verify status shows "Looping" - **VERIFIED**
- [ ] Verify execution pauses at YIELD (shows "Looping (yield pause)")
- [ ] Verify execution automatically resumes after yield pause
- [ ] Verify loop continues indefinitely until stopped
- [ ] Verify device property changes during yield pause affect next iteration

**BLOCKED:** Full Loop mode testing blocked by BUG-001 below.

---

## Bugs Found During Testing

### BUG-001: VS Code Not Compiling - IC10 Panel Shows BASIC Code (BLOCKING)

| Item | Details |
|------|---------|
| **Severity** | **CRITICAL / BLOCKING** |
| **Component** | Visual Scripting â†’ Editor Integration |
| **Status** | Open |

**Description:**
When VS-generated code is sent to the main editor, the IC10/MIPS output panel displays the BASIC source code instead of compiled IC10 assembly. Both panels show identical content.

**Expected Behavior:**
- BASIC panel: Shows BASIC source code
- IC10 panel: Shows compiled IC10 assembly (move, add, lbn, yield, j, etc.)

**Actual Behavior:**
- BASIC panel: Shows BASIC source code
- IC10 panel: Shows BASIC source code (same as left panel)

**Impact:**
- Cannot test Loop mode with device interaction
- Cannot verify simulator behavior with VS-generated scripts
- Blocks thorough testing of LOOP-REGRESSION

**Steps to Reproduce:**
1. Open Visual Scripting
2. Build any script (e.g., device read loop)
3. VS generates code and sends to editor
4. Observe IC10 panel - shows BASIC code instead of IC10 assembly

---

## Bugs Fixed (Verified)

1. **NamedDeviceNode Syntax** - Now generates `ALIAS name = IC.Device[type].Name["label"]`
2. **Main Label Generation** - `Main:` now appears after section header
3. **IF Block Structure** - True branch code now inside IF block regardless of Y position
4. **Error Line Reporting** - Errors now report IF statement start line, not EOF

---

## Conclusion

**v3.0.19 - BLOCKED BY CRITICAL BUG**

All originally planned bug fixes have been confirmed working:
- Default script compiles and runs correctly (missing ENDIF fixed)
- NamedDevice generates correct `IC.Device[].Name[]` syntax
- Main label generated correctly after section header
- IF block structure follows execution flow, not Y position
- Nested IF structures generate correctly (VS-IF-02 verified)
- IF/ELSE branches generate correctly (VS-IF-03 verified)
- Error messages point to IF statement start line, not EOF
- Simulator compilation and run-to-yield works
- Loop button starts and shows "Looping" status (partially verified)

**BLOCKING ISSUE:**
- **BUG-001:** VS-generated code is not being compiled - IC10 panel shows BASIC source instead of compiled assembly
- This prevents thorough Loop mode testing with device interaction

**Release Status:** BLOCKED - BUG-001 must be fixed before Loop mode can be fully tested and release approved.

---

**End of Test Results**
