# Test Results: v3.0.20 Bug Fixes

**Version:** 3.0.20
**Date:** 2025-12-04
**Tester:** Claude Code (QA Instance)
**Test Plan:** `2025-12-04-v3.0.20-bugfixes.md`

---

## Executive Summary

| Category | Result |
|----------|--------|
| **Overall Status** | **PASS** |
| **MCP Tests Executed** | 6/8 |
| **MCP Tests Passed** | 6/6 |
| **Manual Tests Completed** | 1 (LOOP-DEVICE-01) |
| **Manual Tests Remaining** | 2 (VS-SYNC-02, REGRESSION-02) |
| **BUG-001 Status** | **FIXED** |
| **Loop Mode Device Interaction** | **PASS** |

---

## Test Results

### VS-SYNC-01: VS Code Syncs Both Panels
| Item | Result |
|------|--------|
| **Status** | **PASS** |
| **Test Setup** | Created simple VS script (EntryPoint → Yield) |
| **BASIC Panel** | Shows BASIC source: `VAR myVar = 0`, `YIELD` |
| **IC10 Panel** | Shows compiled IC10: `move r0 0`, `Main:`, `yield` |
| **Evidence** | Panels show DIFFERENT content - BASIC on left, IC10 on right |

---

### VS-SYNC-02: AutoCompile Off Still Works
| Item | Result |
|------|--------|
| **Status** | NOT TESTED |
| **Notes** | Requires manual UI: disable AutoCompile in menu, verify VS sync still works |

---

### VS-SYNC-03: Complex Script Sync
| Item | Result |
|------|--------|
| **Status** | **PASS** |
| **Test Setup** | Created complex VS script with: NamedDevice, Variable, IF, Compare, Increment, Yield, Goto |
| **BASIC Generated** | |
```basic
VAR count = 0
ALIAS myLight = IC.Device[StructureWallLight].Name["Test Light"]

MainLoop:
IF (count = 0) THEN
    ++count
ENDIF
YIELD
GOTO MainLoop
```
| **IC10 Generated** | |
```ic10
move r0 0
Main:
MainLoop:
bne r0 0 5
add r0 r0 1
yield
j MainLoop
```
| **Evidence** | Both panels correctly populated - BASIC with high-level code, IC10 with assembly |

---

### VS-SYNC-04: IC10 Line Count Correct
| Item | Result |
|------|--------|
| **Status** | **PASS** |
| **Expected Lines** | 7 (move, Main:, MainLoop:, bne, add, yield, j) |
| **Actual Lines** | 7 |
| **Match** | Yes |

---

### REGRESSION-01: Default Script Still Works
| Item | Result |
|------|--------|
| **Status** | **PASS** |
| **Evidence** | Default script compiles to 47 IC10 lines without errors |
| **Notes** | Verified at session start before VS testing |

---

### REGRESSION-02: Manual Compile Still Works
| Item | Result |
|------|--------|
| **Status** | NOT TESTED |
| **Notes** | Requires manual UI: type BASIC code manually, press F5, verify IC10 output |

---

### REGRESSION-03: Simulator Runs VS Code
| Item | Result |
|------|--------|
| **Status** | **PASS** |
| **Test Setup** | Used complex VS script from VS-SYNC-03 |
| **Simulator Start** | PC: 0, Status: READY |
| **After Run** | PC: 6, Instructions: 4, Status: YIELDING |
| **Register Values** | r0 = 1.0 (count incremented correctly) |
| **Evidence** | VS-synced IC10 code executes correctly in simulator |

---

### REGRESSION-04: Loop Mode Regression
| Item | Result |
|------|--------|
| **Status** | **PASS** (Manual verification earlier in session) |
| **Evidence** | User verified Loop button shows "Looping" status and auto-resumes after yield |
| **Notes** | Full Loop mode testing pending (device interaction test) |

---

## Summary Table

| Test ID | Priority | Status |
|---------|----------|--------|
| VS-SYNC-01 | Critical | **PASS** |
| VS-SYNC-02 | High | NOT TESTED |
| VS-SYNC-03 | High | **PASS** |
| VS-SYNC-04 | Medium | **PASS** |
| REGRESSION-01 | Critical | **PASS** |
| REGRESSION-02 | High | NOT TESTED |
| REGRESSION-03 | High | **PASS** |
| REGRESSION-04 | High | **PASS** |

---

## Critical Tests Summary

| Critical Test | Result |
|--------------|--------|
| VS-SYNC-01 | **PASS** |
| REGRESSION-01 | **PASS** |

**All critical tests passed.**

---

## BUG-001 Resolution

| Item | Details |
|------|---------|
| **Bug** | VS code not syncing compiled IC10 to main editor |
| **Status** | **FIXED** |
| **Verification** | VS-SYNC-01, VS-SYNC-03 both confirm IC10 panel now shows compiled assembly |
| **Root Cause** | Event handler only set BasicEditor.Text, not MipsOutput.Text |
| **Fix** | Now explicitly sets both panels with suppress flags to prevent event loops |

---

## Loop Mode Device Interaction Test

### LOOP-DEVICE-01: Device Editing During Loop
| Item | Result |
|------|--------|
| **Status** | **PASS** (with workaround) |
| **Test Setup** | VS script reading myLight.On into lightState (r0), looping with YIELD |
| **Test Procedure** | STOP loop → Edit register → RESTART loop → Observe behavior |
| **Results** | |
| | - Set On register to 1 → lightState increments each loop ✓ |
| | - Set On register to 0 → lightState stops incrementing ✓ |
| | - Tested through multiple loops and register changes ✓ |
| **Critical Limitations** | |
| | - **MUST STOP loop to edit** - editing while running throws errors |
| | - **No PAUSE option** in loop mode - only Stop/Start |
| | - **Yield pause window too narrow** - not enough time to edit values |
| | - Simulator does NOT auto-update when VS code changes (must close/reopen) |
| | - Named devices (IC.Device[].Name[]) not visible in simulator device list |

---

## Feature Requests Identified

### FR-001: Simulator Auto-Refresh
**Priority:** Medium
**Description:** Simulator window should automatically reload compiled IC10 code when source changes in VS or main editor, or provide a "Reload Code" button.
**Current Behavior:** Must close and reopen simulator window to load updated code.

### FR-002: Named Devices in Simulator UI
**Priority:** High
**Description:** Named devices declared with `ALIAS name = IC.Device[type].Name["label"]` should appear in the simulator's device panel with their alias names, making it easier to:
- Understand which device is which
- Know what properties can be edited
- Make the simulator more accessible to less technical users

**Current Behavior:** Only d0-d5 pin devices shown. Named devices are not visible/editable in the UI.

### FR-003: Pause Button for Loop Mode
**Priority:** High
**Description:** Add a PAUSE button to loop mode that freezes execution, allowing users to:
- Edit registers and device values without errors
- Inspect current state
- Resume from paused state (not restart)

**Current Behavior:**
- Only Stop/Start available - no Pause
- Editing while running throws errors
- Yield pause window too narrow to make edits
- Must fully stop and restart loop to make changes

---

## Manual Testing Checklist

- [ ] **VS-SYNC-02:** Disable AutoCompile, verify VS sync still populates IC10 panel
- [ ] **REGRESSION-02:** Type BASIC code manually, compile with F5, verify IC10 output

---

## Conclusion

**v3.0.20 - BUG-001 FIXED - ALL CRITICAL TESTS PASS**

The VS code sync fix has been verified working:
- Simple VS scripts sync correctly (VS-SYNC-01)
- Complex VS scripts with NamedDevice, IF, loops sync correctly (VS-SYNC-03)
- IC10 line count matches expected output (VS-SYNC-04)
- Simulator executes VS-synced IC10 code correctly (REGRESSION-03)
- Default script compilation unchanged (REGRESSION-01)
- Loop mode continues to work (REGRESSION-04)

**Loop Mode Device Interaction:** PASS (with workaround)
- Register changes correctly affect loop behavior when loop is STOPPED
- On=1 → counter increments, On=0 → counter stops
- Verified through multiple loops and register changes
- **Limitation:** Must stop loop to edit - no pause option, yield window too narrow
- UX improvements documented as feature requests (FR-001, FR-002, FR-003)

**Release Status:** Ready for release. BUG-001 is fixed. Feature requests for simulator improvements documented for future versions.

---

**End of Test Results**
