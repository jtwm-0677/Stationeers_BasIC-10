# BASIC to Stationeers MIPS Compiler

A compiler that translates BASIC programming language code into Stationeers MIPS (IC10) assembly for use in the game [Stationeers](https://store.steampowered.com/app/544550/Stationeers/).

## Features

- Full BASIC language support including:
  - Variables and expressions
  - Mathematical operators (`+`, `-`, `*`, `/`, `^`, `MOD`)
  - Comparison operators (`=`, `<>`, `<`, `>`, `<=`, `>=`)
  - Logical operators (`AND`, `OR`, `NOT`)
  - Control flow (`IF/THEN/ELSE/ENDIF`, `FOR/NEXT`, `WHILE/WEND`, `DO/LOOP`)
  - Subroutines (`GOSUB`, `RETURN`, `SUB/END SUB`)
  - Built-in math functions (`SIN`, `COS`, `TAN`, `SQRT`, `ABS`, `MIN`, `MAX`, etc.)

- Stationeers-specific features:
  - Device aliases (`ALIAS sensor d0`)
  - Constants (`DEFINE THRESHOLD 100`)
  - `YIELD` and `SLEEP` instructions
  - Direct device I/O support

## Building

### Prerequisites

- [.NET 8.0 SDK](https://dotnet.microsoft.com/download/dotnet/8.0) or later

### Build Commands

```bash
# Build for development
dotnet build

# Build release version
dotnet build -c Release

# Create standalone Windows executable
dotnet publish -c Release -r win-x64 --self-contained true
```

The standalone executable will be in `bin/Release/net8.0/win-x64/publish/`.

## Usage

```bash
# Basic usage
BasicToMips program.bas

# Specify output file
BasicToMips program.bas -o output.ic10

# Verbose mode with debugging info
BasicToMips program.bas -v

# Show tokens and AST
BasicToMips program.bas --tokens --ast
```

### Command Line Options

| Option | Description |
|--------|-------------|
| `-o, --output <file>` | Specify output file (default: input.ic10) |
| `-v, --verbose` | Show detailed compilation progress |
| `--tokens` | Display lexer tokens |
| `--ast` | Display abstract syntax tree |
| `-h, --help` | Show help message |

## BASIC Language Reference

### Variables

Variables are automatically declared on first use:

```basic
LET x = 10
LET name$ = "test"
y = 20  ' LET is optional
```

### Control Flow

#### IF/THEN/ELSE

```basic
' Single line
IF x > 10 THEN PRINT "big"

' Multi-line
IF x > 10 THEN
    PRINT "big"
ELSEIF x > 5 THEN
    PRINT "medium"
ELSE
    PRINT "small"
ENDIF
```

#### FOR/NEXT

```basic
FOR i = 1 TO 10
    PRINT i
NEXT i

FOR j = 10 TO 0 STEP -2
    PRINT j
NEXT j
```

#### WHILE/WEND

```basic
WHILE x < 100
    LET x = x + 1
WEND
```

#### DO/LOOP

```basic
DO WHILE x < 100
    LET x = x + 1
LOOP

DO
    LET x = x + 1
LOOP UNTIL x >= 100
```

### Subroutines

```basic
GOSUB 100
END

100 PRINT "In subroutine"
    RETURN
```

### Stationeers-Specific Features

#### Device Aliases

```basic
ALIAS sensor d0
ALIAS display d1
ALIAS valve d2
```

#### Constants

```basic
DEFINE MAX_TEMP 100
DEFINE PI 3.14159
```

#### Device I/O

```basic
INPUT temperature  ' Reads from d0 Setting by default
YIELD              ' Yields execution for one tick
SLEEP 1            ' Sleeps for 1 second
```

### Built-in Functions

| Function | Description |
|----------|-------------|
| `ABS(x)` | Absolute value |
| `SIN(x)` | Sine (radians) |
| `COS(x)` | Cosine (radians) |
| `TAN(x)` | Tangent (radians) |
| `ASIN(x)` | Arc sine |
| `ACOS(x)` | Arc cosine |
| `ATAN(x)` | Arc tangent |
| `ATAN2(y, x)` | Two-argument arc tangent |
| `SQRT(x)` | Square root |
| `EXP(x)` | e^x |
| `LOG(x)` | Natural logarithm |
| `CEIL(x)` | Ceiling |
| `FLOOR(x)` | Floor |
| `ROUND(x)` | Round to nearest |
| `TRUNC(x)` | Truncate to integer |
| `MIN(a, b)` | Minimum of two values |
| `MAX(a, b)` | Maximum of two values |
| `RND()` | Random number 0-1 |

## Examples

See the `examples/` directory for sample programs:

- `hello.bas` - Simple hello world
- `counter.bas` - FOR loop demonstration
- `temperature.bas` - Temperature controller
- `math.bas` - Math functions demo
- `airlock.bas` - Airlock controller
- `solar_tracker.bas` - Solar panel tracker

## Output Format

The compiler generates Stationeers MIPS (IC10) assembly code. The output can be copied directly into an IC10 chip in the game.

Example output:

```mips
# Generated by BASIC to Stationeers MIPS Compiler

alias sensor d0
define THRESHOLD 100

line_10:
move r0 0
for_start_0:
move r1 10
sgt r17 r0 r1
bgtz r1 3
slt r17 r0 r1
bnez r17 for_end_0
# ... more code
```

## License

MIT License
